var jWorkflow=function(){return{order:function(l,m){var f=[],g,h=null,k=function(){var a=!1;return{take:function(){a=!0},pass:function(b){var c;a=!1;g.length?(c=g.shift(),b=c.func.apply(c.context,[b,k]),a||k.pass(b)):h.func&&h.func.apply(h.context,[b])},drop:function(b){a=!0;g=[];setTimeout(function(){k.pass(b)},1)}}}(),e={andThen:function(a,b){if("function"===typeof a.andThen&&"function"===typeof a.start&&"function"===typeof a.chill)f.push({func:function(c,d){d.take();a.start({callback:function(a){setTimeout(function(){d.pass(a)},
1)},context:b,initialValue:c})},context:b});else if(a.map&&a.reduce)f.push({func:function(b,d){d.take();var f=a.length,g=function(){return--f||setTimeout(function(){d.pass()},1)};a.forEach(function(a){jWorkflow.order(a).start(g)})},context:b});else{if("function"!==typeof a)throw"expected function but was "+typeof a;f.push({func:a,context:b})}return e},chill:function(a){return e.andThen(function(b,c){c.take();setTimeout(function(){c.pass(b)},a)})},start:function(a,b){var c,d,e;a&&"object"===typeof a?
(c=a.callback,d=a.context,e=a.initialValue):(c=a,d=b);h={func:c,context:d};g=f.slice();k.pass(e)}};return l?e.andThen(l,m):e}}}();"object"===typeof module&&"function"===typeof require&&(module.exports=jWorkflow);
